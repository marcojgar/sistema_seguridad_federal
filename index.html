<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="assets/images/favicon.png">
    <title>Sistema Inteligente de Alerta e Intervenci칩n Policial</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/styles.css">


</head>

<body class="bg-light-custom">

    <div class="container mt-4">

        <h1 class="text-center mb-4 d-flex justify-content-center align-items-center gap-2 flex-wrap">
            <img src="assets/images/logo-policia.png" alt="SCCP Logo" class="img-fluid" style="max-height:250px;">
            <span>S.I.A.I.P. - Sistema Inteligente de Alerta e Intervenci칩n Policial</span>
        </h1>

        <!-- ================= ADMINISTRACI칍N ================= -->
        <div class="card shadow mb-4">
            <div class="card-header bg-primary text-white">
                Administraci칩n de Dispositivos
            </div>
            <div class="card-body">
                <form id="deviceForm" class="row g-3">

                    <input type="hidden" id="deviceId">

                    <div class="col-md-4">
                        <input type="text" id="nombre" class="form-control" placeholder="Nombre" required>
                    </div>

                    <div class="col-md-4">
                        <input type="text" id="tipo" class="form-control" placeholder="Tipo" required>
                    </div>

                    <div class="col-md-4">
                        <input type="text" id="ubicacion" class="form-control" placeholder="Ubicaci칩n" required>
                    </div>

                    <!-- Nuevos campos -->
                    <div class="col-md-3">
                        <input type="text" id="modelo" class="form-control" placeholder="Modelo">
                    </div>

                    <div class="col-md-3">
                        <input type="text" id="numeroSerie" class="form-control" placeholder="N칰mero de Serie">
                    </div>

                    <div class="col-md-3">
                        <input type="number" id="bateria" class="form-control" placeholder="Bater칤a (%)">
                    </div>

                    <div class="col-md-3">
                        <input type="number" id="consumoEnergia" class="form-control" placeholder="Consumo (W)">
                    </div>

                    <div class="col-md-3">
                        <select id="estado" class="form-select">
                            <option value="Activo">Activo</option>
                            <option value="Inactivo">Inactivo</option>
                            <option value="Mantenimiento">Mantenimiento</option>
                        </select>
                    </div>

                    <div class="col-12 text-center mt-3">
                        <button type="submit" id="submitBtn" class="btn btn-success px-5 me-3">
                            Agregar Dispositivo
                        </button>

                        <button type="button" id="clearBtn" class="btn btn-outline-secondary px-4">
                            Limpiar
                        </button>
                    </div>

                </form>
            </div>
        </div>

        <!-- ================= TABLA ================= -->
        <div class="card shadow mb-4">
            <div class="card-header bg-dark text-white">
                Lista de Dispositivos
            </div>
            <div class="card-body">
                <div class="table-wrapper table-responsive">

                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Nombre</th>
                                <th>Tipo</th>
                                <th>Modelo</th>
                                <th>N춿 Serie</th>
                                <th>Ubicaci칩n</th>
                                <th>Estado</th>
                                <th>Bater칤a</th>
                                <th>Alerta</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="deviceTable"></tbody>
                    </table>
                </div>

            </div>
        </div>

        <!-- ================= PANEL CCTV + CONTROL ================= -->

        <div class="card shadow mb-5">

            <div class="card-header bg-success text-white">

                Centro de Control y Vigilancia

            </div>

            <div class="card-body">

                <div class="row g-4 align-items-stretch">

                    <!-- CAMARA -->
                    <div class="col-lg-5">

                        <div class="camera-card h-100">

                            <div class="camera-header">

                                <span>Seguridad - Puerta trasera</span>

                                <div class="camera-live">

                                    <span class="live-dot"></span>
                                    LIVE

                                </div>

                            </div>

                            <div class="camera-body">

                                <video id="liveCamera" autoplay muted playsinline>
                                </video>

                                <div class="camera-overlay">

                                    <div id="cameraTime"></div>

                                    <div id="cameraStatus">

                                        C치mara Inactiva

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>


                    <!-- CONTROL -->
                    <div class="col-lg-7">

                        <div class="h-100">

                            <h5 class="mb-3 text-success">

                                Control en Tiempo Real

                            </h5>

                            <div id="controlSection" class="row">

                            </div>

                        </div>

                    </div>

                </div>

            </div>

        </div>

        <!-- ================= MONITOREO ================= -->
        <div class="card shadow mb-5">
            <div class="card-header bg-info text-white">
                Monitoreo en Tiempo Real
            </div>
            <div class="card-body">

                <!-- GR츼FICO DE ESTADO -->
                <div class="row mb-4">
                    <div class="col-md-6 col-lg-4 mx-auto">
                        <canvas id="statusChart" style="max-height: 200px; width: 100%;"></canvas>
                    </div>
                </div>

                <!-- Alertas activas -->
                <div id="alertasSection" class="alert alert-warning d-none" role="alert">
                    <strong>丘멆잺 Alertas activas:</strong> <span id="alertasCount">0</span> dispositivo(s) en estado
                    cr칤tico.
                </div>

                <div id="statusCards" class="row mb-4"></div>

                <h5>칔ltimos 10 Cambios</h5>

                <div class="table-wrapper table-responsive">
                    <table class="table table-striped mb-0">
                        <thead class="table-warning">
                            <tr>
                                <th>Dispositivo</th>
                                <th>Estado</th>
                                <th>Bater칤a</th>
                                <th>Fecha</th>
                            </tr>
                        </thead>
                        <tbody id="logTable"></tbody>
                    </table>
                </div>


            </div>
        </div>

    </div>

    <!-- Contenedor de notificaciones -->
    <div id="notificationContainer" style="position: fixed; top: 20px; right: 20px; z-index: 100000;">
    </div>

    <!-- ================= BLOQUEO SISTEMA ================= -->

    <div id="lockScreen" style="

position:fixed;
top:0;
left:0;
width:100%;
height:100%;

background:rgba(0,0,0,.85);

display:none;

justify-content:center;
align-items:center;

z-index:99999;

">

        <div class="card p-4 text-center shadow" style="width:350px;">

            <h4 class="mb-3 text-danger">

                游뚿 Sistema Bloqueado

            </h4>

            <p>

                Intrusi칩n detectada.

                Ingrese contrase침a.

            </p>

            <input id="passwordInput" type="password" class="form-control mb-3" placeholder="Contrase침a">

            <button class="btn btn-danger w-100" onclick="desbloquearSistema()">

                Desbloquear

            </button>

        </div>

    </div>

    <!-- ================= FOOTER ================= -->
    <footer class="bg-dark text-white text-center py-3 mt-4">
        <div class="container d-flex flex-column flex-md-row justify-content-center align-items-center gap-3">

            <div>
                춸 <span id="year"></span> Desarrollado por <strong>Marco Julian Garcia Fernandez</strong>
            </div>

            <div>
                <a href="https://www.linkedin.com/in/marco-julian-garcia-fernandez-9941b53a9/" target="_blank"
                    class="text-white fs-4" style="text-decoration: none;">
                    <i class="bi bi-linkedin"></i>
                </a>
            </div>

        </div>
    </footer>


    <script src="js/admin.js"></script>
</body>

</html>